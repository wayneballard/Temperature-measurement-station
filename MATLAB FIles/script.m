measurements = readmatrix("measurements.txt")
Ts = 1;
input_amplitude = 0.9 %assumed to be 90 percent of PWM duty cycle
samples = length(measurements);
input = input_amplitude*ones(1 , samples); %create input for linear simulation
t = (0:samples-1)*Ts %time vector creation
s = tf('s');
plot(measurements) 
hold on;

k = 2.2/input_amplitude
T = 330
H = k/(1+s*T)*exp(-s*20);

model = lsim(H, input, t);
model = model + 24.5 %offset
plot(model)
legend('Raw Measurements', 'Model Response')
xlabel('Time[s]')
ylabel(['Temperature[' char(176) 'C' ']'])
% response = [6.005000 ,6.015000 ,6.025000 ,6.035000 ,6.045000 ,6.055000 ,6.065000 ,6.075000 ,6.085000 ,6.095000 ,6.105000 ,6.115000 ,6.125000 ,6.135000 ,6.145000 ,6.155000 ,6.165000 ,6.175000 ,6.185000 ,6.195000 ,6.205000 ,6.215000 ,6.225000 ,6.235000 ,6.245000 ,6.255000 ,6.265000 ,6.275000 ,6.285000 ,6.295000 ,6.305000 ,6.315000 ,6.325000 ,6.335000 ,6.345000 ,6.355000 ,6.365000 ,6.375000 ,6.385000 ,6.395000 ,6.405000 ,6.415000 ,6.425000 ,6.435000 ,6.445000 ,6.455000 ,6.465000 ,6.475000 ,6.485000 ,6.495000 ,6.505000 ,6.515000 ,6.525000 ,6.535000 ,6.545000 ,6.555000 ,6.565000 ,6.575000 ,6.585000 ,6.595000 ,6.605000 ,6.615000 ,6.625000 ,6.635000 ,6.645000 ,6.655000 ,6.665000 ,6.675000 ,6.685000 ,6.695000 ,6.705000 ,6.715000 ,6.725000 ,6.735000 ,6.745000 ,6.755000 ,6.765000 ,6.775000 ,6.785000 ,6.795000 ,6.805000 ,6.815000 ,6.825000 ,6.835000 ,6.845000 ,6.855000 ,6.865000 ,6.875000 ,6.885000 ,6.895000 ,6.905000 ,6.915000 ,6.925000 ,6.935000 ,6.945000 ,6.955000 ,6.965000 ,6.975000 ,6.985000 ,6.995000 ,7.005000 ,7.015000 ,7.025000 ,7.035000 ,7.045000 ,7.055000 ,7.065000 ,7.075000 ,7.085000 ,7.095000 ,7.105000 ,7.115000 ,7.125000 ,7.135000 ,7.145000 ,7.155000 ,7.165000 ,7.175000 ,7.185000 ,7.195000 ,7.205000 ,7.215000 ,7.225000 ,7.235000 ,7.245000 ,7.255000 ,7.265000 ,7.275000 ,7.285000 ,7.295000 ,7.305000 ,7.315000 ,7.325000 ,7.335000 ,7.345000 ,7.355000 ,7.365000 ,7.375000 ,7.385000 ,7.395000 ,7.405000 ,7.415000 ,7.425000 ,7.435000 ,7.445000 ,7.455000 ,7.465000 ,7.475000 ,7.485000 ,7.495000 ,7.505000 ,7.515000 ,7.525000 ,7.535000 ,7.545000 ,7.555000 ,7.565000 ,7.575000 ,7.585000 ,7.595000 ,7.605000 ,7.615000 ,7.625000 ,7.635000 ,7.645000 ,7.655000 ,7.665000 ,7.675000 ,7.685000 ,7.695000 ,7.705000 ,7.715000 ,7.725000 ,7.735000 ,7.745000 ,7.755000 ,7.765000 ,7.775000 ,7.785000 ,7.795000 ,7.805000 ,7.815000 ,7.825000 ,7.835000 ,7.845000 ,7.855000 ,7.865000 ,7.875000 ,7.885000 ,7.895000 ,7.905000 ,7.915000 ,7.925000 ,7.935000 ,7.945000 ,7.955000 ,7.965000 ,7.975000 ,7.985000 ,7.995000 ,8.005000 ,8.014999 ,8.025000 ,8.035000 ,8.045000 ,8.055000 ,8.065001 ,8.075000 ,8.085000 ,8.095000 ,8.105000 ,8.115000 ,8.125000 ,8.135000 ,8.145000 ,8.155000 ,8.165000 ,8.175000 ,8.184999 ,8.195000 ,8.205000 ,8.215000 ,8.225000 ,8.235000 ,8.245000 ,8.255000 ,8.264999 ,8.275000 ,8.285000 ,8.295000 ,8.305000 ,8.315001 ,8.325000 ,8.335000 ,8.345000 ,8.355000 ,8.365000 ,8.375000 ,8.385000 ,8.395000 ,8.405000 ,8.415000 ,8.425000 ,8.434999 ,8.445000 ,8.455000 ,8.465000 ,8.475000 ,8.485000 ,8.495000 ,8.505000 ,8.514999 ,8.525000 ,8.535000 ,8.545000 ,8.555000 ,8.565001 ,8.575000 ,8.585000 ,8.595000 ,8.605000 ,8.615000 ,8.625000 ,8.635000 ,8.645000 ,8.655000 ,8.665000 ,8.675000 ,8.684999 ,8.695000 ,8.705000 ,8.715000 ,8.725000 ,8.735000 ,8.745000 ,8.755000 ,8.764999 ,8.775000 ,8.785000 ,8.795000 ,8.805000 ,8.815000 ,8.825000 ,8.835000 ,8.845000 ,8.855000 ,8.865000 ,8.875000 ,8.885000 ,8.895000 ,8.905000 ,8.915000 ,8.925000 ,8.934999 ,8.945000 ,8.955000 ,8.965000 ,8.975000 ,8.985000 ,8.995000 ,9.005000 ,9.014999 ,9.025000 ,9.035000 ,9.045000 ,9.055000 ,9.065000 ,9.075000 ,9.085000 ,9.095000 ,9.105000 ,9.115000 ,9.125000 ,9.135000 ,9.145000 ,9.155000 ,9.165000 ,9.175000 ,9.184999 ,9.195000 ,9.205000 ,9.215000 ,9.225000 ,9.235000 ,9.245000 ,9.255000 ,9.264999 ,9.275000 ,9.285000 ,9.295000 ,9.305000 ,9.315000 ,9.325000 ,9.335000 ,9.345000 ,9.355000 ,9.365000 ,9.375000 ,9.385000 ,9.395000 ,9.405000 ,9.415000 ,9.425000 ,9.434999 ,9.445000 ,9.455000 ,9.465000 ,9.475000 ,9.485000 ,9.495000 ,9.505000 ,9.514999 ,9.525000 ,9.535000 ,9.545000 ,9.555000 ,9.565000 ,9.575000 ,9.585000 ,9.595000 ,9.605000 ,9.615000 ,9.625000 ,9.635000 ,9.645000 ,9.655000 ,9.665000 ,9.675000 ,9.684999 ,9.695000 ,9.705000 ,9.715000 ,9.725000 ,9.735000 ,9.745000 ,9.755000 ,9.764999 ,9.775000 ,9.785000 ,9.795000 ,9.805000 ,9.815000 ,9.825000 ,9.835000 ,9.845000 ,9.855000 ,9.865000 ,9.875000 ,9.885000 ,9.895000 ,9.905000 ,9.915000 ,9.925000 ,9.934999 ,9.945000 ,9.955000 ,9.965000 ,9.975000 ,9.985000 ,9.995000 ,10.005000 ,10.014999 ,10.025000 ,10.035000 ,10.045000 ,10.055000 ,10.065001 ,10.075000 ,10.085000 ,10.094999 ,10.105000 ,10.115000 ,10.125000 ,10.135000 ,10.145000 ,10.155000 ,10.165000 ,10.174999 ,10.184999 ,10.195000 ,10.205000 ,10.215000 ,10.225000 ,10.235001 ,10.245000 ,10.255000 ,10.264999 ,10.275000 ,10.285000 ,10.295000 ,10.305000 ,10.315001 ,10.325000 ,10.335000 ,10.344999 ,10.355000 ,10.365000 ,10.375000 ,10.385000 ,10.395000 ,10.405000 ,10.415000 ,10.424999 ,10.434999 ,10.445000 ,10.455000 ,10.465000 ,10.475000 ,10.485001 ,10.495000 ,10.505000 ,10.514999 ,10.525000 ,10.535000 ,10.545000 ,10.555000 ,10.565001 ,10.575000 ,10.585000 ,10.594999 ,10.605000 ,10.615000 ,10.625000 ,10.635000 ,10.645000 ,10.655000 ,10.665000 ,10.674999 ,10.684999 ,10.695000 ,10.705000 ,10.715000 ,10.725000 ,10.735000 ,10.745000 ,10.755000 ,10.764999 ,10.775000 ,10.785000 ,10.795000 ,10.805000 ,10.815001 ,10.825000 ,10.835000 ,10.844999 ,10.855000 ,10.865000 ,10.875000 ,10.885000 ,10.895000 ,10.905000 ,10.915000 ,10.924999 ,10.934999 ,10.945000 ,10.955000 ,10.965000 ,10.975000 ,10.985000 ,10.995000 ,11.005000 ,11.014999 ,11.025000 ,11.035000 ,11.045000 ,11.055000 ,11.065001 ,11.075000 ,11.085000 ,11.094999 ,11.105000 ,11.115000 ,11.125000 ,11.135000 ,11.145000 ,11.155000 ,11.165000 ,11.174999 ,11.184999 ,11.195000 ,11.205000 ,11.215000 ,11.225000 ,11.235000 ,11.245000 ,11.255000 ,11.264999 ,11.275000 ,11.285000 ,11.295000 ,11.305000 ,11.315001 ,11.325000 ,11.335000 ,11.344999 ,11.355000 ,11.365000 ,11.375000 ,11.385000 ,11.395000 ,11.405000 ,11.415000 ,11.424999 ,11.434999 ,11.445000 ,11.455000 ,11.465000 ,11.475000 ,11.485000 ,11.495000 ,11.505000 ,11.514999 ,11.525000 ,11.535000 ,11.545000 ,11.555000 ,11.565001 ,11.575000 ,11.585000 ,11.594999 ,11.605000 ,11.615000 ,11.625000 ,11.635000 ,11.645000 ,11.655000 ,11.665000 ,11.674999 ,11.684999 ,11.695000 ,11.705000 ,11.715000 ,11.725000 ,11.735000 ,11.745000 ,11.754999 ,11.764999 ,11.775000 ,11.785000 ,11.795000 ,11.805000 ,11.815001 ,11.825000 ,11.835000 ,11.844999 ,11.855000 ,11.865000 ,11.875000 ,11.885000 ,11.895000 ,11.905000 ,11.915000 ,11.924999 ,11.934999 ,11.945000 ,11.955000 ,11.965000 ,11.975000 ,11.985000 ,11.995000 ,12.004999 ,12.014999 ,12.025000 ,12.035000 ,12.045000 ,12.055000 ,12.065001 ,12.075000 ,12.085000 ,12.094999 ,12.105000 ,12.115000 ,12.125000 ,12.135000 ,12.145000 ,12.155000 ,12.165000 ,12.174999 ,12.184999 ,12.195000 ,12.205000 ,12.215000 ,12.225000 ,12.235000 ,12.245000 ,12.254999 ,12.264999 ,12.275000 ,12.285000 ,12.295000 ,12.305000 ,12.315001 ,12.325000 ,12.335000 ,12.344999 ,12.355000 ,12.365000 ,12.375000 ,12.385000 ,12.395000 ,12.405000 ,12.415000 ,12.424999 ,12.434999 ,12.445000 ,12.455000 ,12.465000 ,12.475000 ,12.485000 ,12.495000 ,12.504999 ,12.514999 ,12.525000 ,12.535000 ,12.545000 ,12.555000 ,12.565001 ,12.575000 ,12.585000 ,12.594999 ,12.605000 ,12.615000 ,12.625000 ,12.635000 ,12.645000 ,12.655000 ,12.665000 ,12.674999 ,12.684999 ,12.695000 ,12.705000 ,12.715000 ,12.725000 ,12.735000 ,12.745000 ,12.754999 ,12.764999 ,12.775000 ,12.785000 ,12.795000 ,12.805000 ,12.815001 ,12.825000 ,12.835000 ,12.844999 ,12.855000 ,12.865000 ,12.875000 ,12.885000 ,12.895000 ,12.905000 ,12.915000 ,12.924999 ,12.934999 ,12.945000 ,12.955000 ,12.965000 ,12.975000 ,12.985000 ,12.995000 ,13.004999 ,13.014999 ,13.025000 ,13.035000 ,13.045000 ,13.055000 ,13.065001 ,13.075000 ,13.085000 ,13.094999 ,13.105000 ,13.115000 ,13.125000 ,13.135000 ,13.145000 ,13.155000 ,13.165000 ,13.174999 ,13.184999 ,13.195000 ,13.205000 ,13.215000 ,13.225000 ,13.235000 ,13.245000 ,13.254999 ,13.264999 ,13.275000 ,13.285000 ,13.295000 ,13.305000 ,13.315001 ,13.325000 ,13.335000 ,13.344999 ,13.355000 ,13.365000 ,13.375000 ,13.385000 ,13.395000 ,13.405000 ,13.415000 ,13.424999 ,13.434999 ,13.445000 ,13.455000 ,13.465000 ,13.475000 ,13.485000 ,13.495000 ,13.504999 ,13.514999 ,13.525000 ,13.535000 ,13.545000 ,13.555000 ,13.565001 ,13.575000 ,13.585000 ,13.594999 ,13.605000 ,13.615000 ,13.625000 ,13.635000 ,13.645000 ,13.655000 ,13.665000 ,13.674999 ,13.684999 ,13.695000 ,13.705000 ,13.715000 ,13.725000 ,13.735000 ,13.745000 ,13.754999 ,13.764999 ,13.775000 ,13.785000 ,13.795000 ,13.805000 ,13.815001 ,13.825000 ,13.835000 ,13.844999 ,13.855000 ,13.865000 ,13.875000 ,13.885000 ,13.895000 ,13.905000 ,13.915000 ,13.924999 ,13.934999 ,13.945000 ,13.955000 ,13.965000 ,13.975000 ,13.985000 ,13.995000 ,14.005000 ,14.014999 ,14.025000 ,14.035000 ,14.045000 ,14.054999 ,14.065000 ,14.075000 ,14.085000 ,14.095000 ,14.105000 ,14.115000 ,14.125000 ,14.135000 ,14.145000 ,14.155000 ,14.165000 ,14.175000 ,14.184999 ,14.195000 ,14.205000 ,14.215000 ,14.224999 ,14.235000 ,14.245000 ,14.255000 ,14.264999 ,14.275000 ,14.285000 ,14.295000 ,14.304999 ,14.315000 ,14.325000 ,14.335000 ,14.345000 ,14.355000 ,14.365000 ,14.375000 ,14.385000 ,14.395000 ,14.405000 ,14.415000 ,14.425000 ,14.434999 ,14.445000 ,14.455000 ,14.465000 ,14.474999 ,14.485000 ,14.495000 ,14.505000 ,14.514999 ,14.525000 ,14.535000 ,14.545000 ,14.554999 ,14.565000 ,14.575000 ,14.585000 ,14.595000 ,14.605000 ,14.615000 ,14.625000 ,14.635000 ,14.645000 ,14.655000 ,14.665000 ,14.675000 ,14.684999 ,14.695000 ,14.705000 ,14.715000 ,14.724999 ,14.735000 ,14.745000 ,14.755000 ,14.764999 ,14.775000 ,14.785000 ,14.795000 ,14.804999 ,14.815000 ,14.825000 ,14.835000 ,14.845000 ,14.855000 ,14.865000 ,14.875000 ,14.885000 ,14.895000 ,14.905000 ,14.915000 ,14.925000 ,14.934999 ,14.945000 ,14.955000 ,14.965000 ,14.974999 ,14.985000 ,14.995000 ,15.005000 ,15.014999 ,15.025000 ,15.035000 ,15.045000 ,15.054999 ,15.065000 ,15.075000 ,15.085000 ,15.095000 ,15.105000 ,15.115000 ,15.125000 ,15.135000 ,15.145000 ,15.155000 ,15.165000 ,15.175000 ,15.184999 ,15.195000 ,15.205000 ,15.215000 ,15.224999 ,15.235000 ,15.245000 ,15.255000 ,15.264999 ,15.275000 ,15.285000 ,15.295000 ,15.304999 ,15.315000 ,15.325000 ,15.335000 ,15.345000 ,15.355000 ,15.365000 ,15.375000 ,15.385000 ,15.395000 ,15.405000 ,15.415000 ,15.425000 ,15.434999 ,15.445000 ,15.455000 ,15.465000 ,15.474999 ,15.485000 ,15.495000 ,15.505000 ,15.514999 ,15.525000 ,15.535000 ,15.545000 ,15.554999 ,15.565000 ,15.575000 ,15.585000 ,15.594999 ,15.605000 ,15.615000 ,15.625000 ,15.635000 ,15.645000 ,15.655000 ,15.665000 ,15.675000 ,15.684999 ,15.695000 ,15.705000 ,15.715000 ,15.724999 ,15.735000 ,15.745000 ,15.755000 ,15.764999 ,15.775000 ,15.785000 ,15.795000 ,15.804999 ,15.815000 ,15.825000 ,15.835000 ,15.844999 ,15.855000 ,15.865000 ,15.875000 ,15.885000 ,15.895000 ,15.905000 ,15.915000 ,15.925000 ,15.934999 ,15.945000 ,15.955000 ,15.965000 ,15.974999 ,15.985000 ,15.995000 ]
% plot(response);